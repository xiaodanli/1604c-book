require(["jquery","render","text!searchTpl","lazyload","storage"],function(o,e,t,a,n){o("body").append(t),o(".icon-back").on("click",function(){location.href="/"}),o.ajax({url:"/api/search-hot",dataType:"json",success:function(t){console.log(t),1===t.code&&e("#tag-tpl",".hot",t.data.ads)},error:function(t){console.log(t)}});var i=o(".tag-wrap"),s=o(".search-list"),r=o(".ipt");o(".search-btn").on("click",function(){var t=r.val();t?l(t):(s.html("<p>输入内容为空</p>"),i.hide(),s.show())});var c=n.get("history")||[];function l(a){c.some(function(t){return t.ad_name===a})||(c.push({ad_name:a}),n.set("history",c)),o.ajax({url:"/api/search?key="+a,dataType:"json",success:function(t){console.log(t),i.hide(),s.show(),1===t.code&&(t.data?(e("#search-template",".search-list",t.data.items,!0),o("img[data-original]").lazyload({effect:"fadeIn",threshold:200,container:o(".search-list")})):s.html("<p>没有相应的数据</p>"))},error:function(t){console.warn(t)}})}0<c.length&&(e("#tag-tpl",".history",c,!0),o(".history-title").show()),r.on("input",function(){o(this).val()||(i.show(),s.hide(),e("#tag-tpl",".history",c,!0),o(".history-title").show())}),o(".tag-wrap").on("click","li",function(){var t=o(this).text();r.val(t),l(t)})});